var listsub={page:1,size:10,topicType:0,topicTypeName:"\u5e16\u5b50\u5217\u8868",template:'<li class="mui-table-view-cell" id="%{id}"><div class="media"><a class="pull-left" href="javascript:;"><img class="media-object" src="%{headUrl}" alt="" width="48" height="48"></a><div class="media-body"><h4 class="media-heading">%{nickname}</h4><h6>%{createTime} <span class="mui-pull-right mui-badge mui-badge-primary mui-badge-inverted">\u8bc4\u8bba\uff08%{commentCount}\uff09</span></h6><div>%{content}</div></div></div></li>',
start:function(){listsub.before();mui.init({pullRefresh:{container:"#container",down:{contentdown:"\u4e0b\u62c9\u5237\u65b0",contentover:"\u91ca\u653e\u7acb\u5373\u5237\u65b0",contentrefresh:"\u6b63\u5728\u5237\u65b0...",callback:listsub.pullDownRefresh},up:{contentdown:"",contentrefresh:"\u6b63\u5728\u52a0\u8f7d...",contentnomore:"\u52a0\u8f7d\u5b8c\u6bd5",callback:listsub.pullUpRefresh}}});listsub.after()},before:function(){window.addEventListener("refresh",function(b){listsub.pullDownRefresh()})},
after:function(){listsub.pReady()},pReady:function(){mui.plusReady(function(){var b=plus.webview.currentWebview();listsub.topicType=b._id;listsub.topicTypeName=b._name;listsub.page=1;listsub.size=Constant.defaultPageSize;listsub.load()})},pullDownRefresh:function(){mui("#container").pullRefresh().refresh(!0);jq("#topicList").html("");listsub.page=1;listsub.load(function(b){mui("#container").pullRefresh().endPulldownToRefresh()})},pullUpRefresh:function(){listsub.page+=1;var b=this;listsub.load(function(a){a.length<
listsub.size?b.endPullupToRefresh(!0):b.endPullupToRefresh(!1)})},load:function(b){Ajax.post(Ajax.url.topicList,{page:listsub.page,typeId:listsub.topicType},function(a){var d="",e,c;for(c in a){e="";for(var f in a[c].listImageUrl)e+='<div class="mui-table-view-cell mui-media mui-col-sm-3" id="%{id}"><img src="%{image}" width=60 height=60></div>'.replace("%{id}",a[c].id).replace("%{image}",Constant.hostname+a[c].listImageUrl[f]);d+=listsub.template.replace("%{id}",a[c].id).replace("%{createTime}",
moment((new Date(a[c].createTime)).format("yyyy-MM-dd HH:mm"),"YYYY-MM-DD HH:mm").fromNow()).replace("%{headUrl}",Constant.hostname+a[c].clientHeadUrl).replace("%{nickname}",a[c].clientNickName).replace("%{content}",a[c].content).replace("%{commentCount}",a[c].commentCount)}jq("#topicList").append(d);listsub.addItemListener();void 0!=b&&b(a)})},addItemListener:function(){mui(".mui-table-view").off("tap",".mui-table-view-cell");mui(".mui-table-view").on("tap",".mui-table-view-cell",function(){var b=
this.getAttribute("id");mui.openWindow({id:"detailmain.html",url:"detailmain.html",extras:{_id:b}})})}};
